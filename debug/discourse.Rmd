---
title: "Untitled"
output: pdf_document
---

```{r}
library(data.table)
library(bit64)
library(ggplot2)
library(dplyr)
library(tidyr)
setwd("~/alignment/debug")
df <- fread('discourse_results.csv', header=T)
d <- df %>%
  group_by(verifiedSpeaker, verifiedReplier) %>%
  summarize(num=n(), alignment=mean(alignment), verifiedReplier=verifiedReplier, verifiedSpeaker=verifiedSpeaker)
filter(d, verifiedSpeaker==TRUE, verifiedReplier==FALSE, replyMarker==TRUE)$num/filter(d, verifiedSpeaker==TRUE, verifiedReplier==FALSE, replyMarker==FALSE)$num

filter(d, verifiedSpeaker==TRUE, verifiedReplier==TRUE, replyMarker==TRUE)$num/filter(d, verifiedSpeaker==TRUE, verifiedReplier==TRUE, replyMarker==FALSE)$num

filter(d, verifiedSpeaker==FALSE, verifiedReplier==TRUE, replyMarker==TRUE)$num/filter(d, verifiedSpeaker==FALSE, verifiedReplier==TRUE, replyMarker==FALSE)$num

filter(d, verifiedSpeaker==FALSE, verifiedReplier==FALSE, replyMarker==TRUE)$num/filter(d, verifiedSpeaker==FALSE, verifiedReplier==FALSE, replyMarker==FALSE)$num

ggplot(d, aes(x=verifiedReplier, y=alignment)) + geom_violin() + facet_wrap(~verifiedSpeaker, scales="free")
```